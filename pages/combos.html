<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Combos ‚Äì Cuentas NetUy</title>
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body>
    <header>
      <nav class="navbar">
        <div class="logo">
          <img src="../img/logo.png" alt="logo" /> CUENTAS NET UY
        </div>
        <ul class="nav-links">
          <li><a href="../index.html">Inicio</a></li>
          <li><a href="combos.html">Combos</a></li>
          <li><a href="./contacto.html">Contacto</a></li>
        </ul>
        <div class="cart-icon">üõí</div>
      </nav>
    </header>

    <main>
      <section>
        <h1 class="titulo-combos">Combos Promocionales</h1>
        <p>Aprovech√° estos packs al mejor precio üî•</p>
        <!-- Ac√° peg√°s el <div class="combo-grid"> con tus combos -->
        <div class="combo-grid">
          <div class="combo-card">
            <h3>üî• Combo Esencial</h3>
            <ul>
              <li>Netflix Est√°ndar (2 pantallas)</li>
              <li>Flujo TV</li>
            </ul>
            <p class="old-price">$1.000</p>
            <p class="new-price">
              $750 <span class="ahorro">Ahorr√°s $250</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Esencial"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üòå Combo Relax</h3>
            <ul>
              <li>Amazon Prime Video</li>
              <li>Disney+ Pantalla</li>
              <li>MAX Pantalla</li>
            </ul>
            <p class="old-price">$720</p>
            <p class="new-price">
              $550 <span class="ahorro">Ahorr√°s $170</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Relax"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üéÆ Combo Gamer/Anime</h3>
            <ul>
              <li>Crunchyroll Cuenta</li>
              <li>Spotify</li>
              <li>Flujo TV</li>
            </ul>
            <p class="old-price">$800</p>
            <p class="new-price">
              $600 <span class="ahorro">Ahorr√°s $200</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Gamer/Anime"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üçø Combo Full Cine</h3>
            <ul>
              <li>Netflix Premium</li>
              <li>MAX Cuenta</li>
              <li>Paramount+ Cuenta</li>
            </ul>
            <p class="old-price">$1.200</p>
            <p class="new-price">
              $950 <span class="ahorro">Ahorr√°s $250</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Full%20Cine"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üë®‚Äçüë©‚Äçüëß Combo Familiar</h3>
            <ul>
              <li>Netflix Est√°ndar</li>
              <li>Disney+ Cuenta</li>
              <li>Spotify</li>
            </ul>
            <p class="old-price">$1.300</p>
            <p class="new-price">
              $1.100 <span class="ahorro">Ahorr√°s $200</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Familiar"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üí∏ Combo Smart</h3>
            <ul>
              <li>Netflix Est√°ndar</li>
              <li>Disney+ Pantalla</li>
            </ul>
            <p class="old-price">$830</p>
            <p class="new-price">
              $790 <span class="ahorro">Ahorr√°s $40</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Smart"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üíé Combo Premium Ahorro</h3>
            <ul>
              <li>Netflix Premium</li>
              <li>Disney+ Pantalla</li>
            </ul>
            <p class="old-price">$990</p>
            <p class="new-price">
              $920 <span class="ahorro">Ahorr√°s $70</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Premium%20Ahorro"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üé¨ Combo B√°sico + Prime</h3>
            <ul>
              <li>Netflix B√°sico</li>
              <li>Amazon Prime Video</li>
            </ul>
            <p class="old-price">$780</p>
            <p class="new-price">
              $710 <span class="ahorro">Ahorr√°s $70</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20B√°sico%20+%20Prime"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>

          <div class="combo-card">
            <h3>üéß Combo Triple Streaming</h3>
            <ul>
              <li>Netflix B√°sico</li>
              <li>Amazon Prime Video</li>
              <li>Spotify</li>
            </ul>
            <p class="old-price">$1.080</p>
            <p class="new-price">
              $960 <span class="ahorro">Ahorr√°s $120</span>
            </p>
            <a
              href="https://wa.me/59895100778?text=Hola,%20quiero%20activar%20el%20Combo%20Triple%20Streaming"
              class="combo-btn"
              target="_blank"
              >Activar por WhatsApp</a
            >
          </div>
        </div>
      </section>
      <section class="simulador-combos">
        <h2>üßÆ Arm√° tu Combo Personalizado</h2>
        <p>
          Seleccion√° los servicios que quer√©s contratar. El precio se actualiza
          autom√°ticamente.
        </p>

        <form id="comboForm">
          <div class="combo-icons-grid">
            <div
              class="combo-icon"
              data-precio="390"
              data-servicio="Netflix B√°sico"
            >
              <img src="img/netflix.svg" alt="Netflix" />
              <span>Netflix B√°sico<br />$390</span>
            </div>
            <div
              class="combo-icon"
              data-precio="520"
              data-servicio="Netflix Est√°ndar"
            >
              <img src="img/netflix.svg" alt="Netflix" />
              <span>Netflix Est√°ndar<br />$520</span>
            </div>
            <div
              class="combo-icon"
              data-precio="680"
              data-servicio="Netflix Premium"
            >
              <img src="img/netflix.svg" alt="Netflix" />
              <span>Netflix Premium<br />$680</span>
            </div>
            <div
              class="combo-icon"
              data-precio="310"
              data-servicio="Disney+ Pantalla"
            >
              <img src="img/disney.svg" alt="Disney+" />
              <span>Disney+ Pantalla<br />$310</span>
            </div>
            <div
              class="combo-icon"
              data-precio="640"
              data-servicio="Disney+ Cuenta"
            >
              <img src="img/disney.svg" alt="Disney+" />
              <span>Disney+ Cuenta<br />$640</span>
            </div>
            <div
              class="combo-icon"
              data-precio="390"
              data-servicio="Amazon Prime"
            >
              <img src="img/prime.svg" alt="Prime Video" />
              <span>Amazon Prime<br />$390</span>
            </div>
            <div class="combo-icon" data-precio="300" data-servicio="Spotify">
              <img src="img/spotify.svg" alt="Spotify" />
              <span>Spotify<br />$300</span>
            </div>
            <div class="combo-icon" data-precio="380" data-servicio="MAX">
              <img src="../img/Max-400x200.png" alt="MAX" />
              <span>MAX<br />$380</span>
            </div>
            <div
              class="combo-icon"
              data-precio="230"
              data-servicio="Paramount+"
            >
              <img src="../img/Paramount-plus-600x300.png" alt="Paramount+" />
              <span>Paramount+<br />$230</span>
            </div>
            <div class="combo-icon" data-precio="220" data-servicio="ViX">
              <img src="../img/netflix.png" alt="ViX" />
              <span>ViX<br />$220</span>
            </div>
          </div>

          <div class="resultado-combo">
            <p id="comboResumen">Total: $0</p>
          </div>

          <button type="button" id="enviarWA" class="combo-btn" disabled>
            Enviar por WhatsApp
          </button>
        </form>
      </section>
    </main>
    <!-- armado de combo automatico -->
    <script>
      document.addEventListener("DOMContentLoaded", async function () {
        const comboGrid = document.querySelector(".combo-icons-grid");
        const resumen = document.getElementById("comboResumen");
        const btnWA = document.getElementById("enviarWA");

        let datos,
          seleccionados = [];

        // Cargar JSON
        try {
          const response = await fetch("../data/precios-combos.json");
          datos = await response.json();
          renderServicios(datos.servicios);
        } catch (e) {
          resumen.textContent = "Error al cargar datos.";
          return;
        }

        function renderServicios(servicios) {
          comboGrid.innerHTML = "";
          servicios.forEach((s) => {
            const div = document.createElement("div");
            div.classList.add("combo-icon");
            div.setAttribute("data-servicio", s.nombre);
            div.setAttribute("data-precio", s.precio);
            div.innerHTML = `
        <img src="img/${s.nombre.split(" ")[0].toLowerCase()}.svg" alt="${
              s.nombre
            }">
        <span>${s.nombre}<br>$${s.precio}</span>
      `;
            div.addEventListener("click", () => toggleSeleccion(div));
            comboGrid.appendChild(div);
          });
        }

        function toggleSeleccion(div) {
          const nombre = div.dataset.servicio;
          const precio = parseInt(div.dataset.precio);
          div.classList.toggle("active");

          const ya = seleccionados.find((s) => s.nombre === nombre);
          if (ya) {
            seleccionados = seleccionados.filter((s) => s.nombre !== nombre);
          } else {
            seleccionados.push({ nombre, precio });
          }

          calcularTotal();
        }

        function calcularTotal() {
          let total = seleccionados.reduce((acc, s) => acc + s.precio, 0);
          let descuento = 0;
          let precioComboDetectado = null;

          // Detectar combo exacto
          datos.combos.forEach((combo) => {
            const nombres = seleccionados
              .map((s) => s.nombre)
              .sort()
              .join(",");
            const comboNombres = combo.servicios.sort().join(",");
            if (nombres === comboNombres) {
              total = combo.precio;
              precioComboDetectado = combo.nombre;
            }
          });

          // Si no hay combo exacto y hay m√°s de 2, aplica 10% off
          if (!precioComboDetectado && seleccionados.length >= 3) {
            descuento = total * 0.1;
            total -= descuento;
          }

          resumen.textContent =
            seleccionados.length > 0
              ? `Elegiste ${seleccionados.length} servicio(s): $${total.toFixed(
                  0
                )} ${
                  precioComboDetectado
                    ? `(Combo: ${precioComboDetectado})`
                    : descuento > 0
                    ? "(10% OFF)"
                    : ""
                }`
              : "Total: $0";

          btnWA.disabled = seleccionados.length === 0;

          btnWA.onclick = () => {
            const mensaje = `Hola, quiero contratar este combo personalizado:\n- ${seleccionados
              .map((s) => s.nombre)
              .join("\n- ")}\nTotal: $${total.toFixed(0)}${
              precioComboDetectado
                ? " (Combo promocional)"
                : descuento > 0
                ? " (10% OFF)"
                : ""
            }`;
            const telefono = "59895100778"; // Cambi√° esto por tu n√∫mero
            const url = `https://wa.me/${telefono}?text=${encodeURIComponent(
              mensaje
            )}`;
            window.open(url, "_blank");
          };
        }
      });
    </script>
  </body>
</html>
